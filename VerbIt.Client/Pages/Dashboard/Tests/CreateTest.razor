@page "/dashboard/tests/create"

<h3 class="mt-2 text-3xl ml-5">Create New Test</h3>

<section id="controls" class="flex gap-2 m-5">
    <button class="btn-main-action ml-auto" dislabed="@IsSaving" @onclick="SaveListClicked">Save list</button>
</section>

<div class="grid grid-cols-2 gap-5">
    @*Left side, displays master lists to select from*@
    <section id="masterListSelector" class="@($"flex flex-col px-2 {(!IsListSelectorVisible ? "hidden" : "")}")">
        <h4 class="mt-2 text-2xl ml-5 text-center">Select base Master List</h4>
        <table class="w-full">
            <thead>
                <tr>
                    <th class="font-bold text-left" scope="col">List Name</th>
                    <th class="font-bold" scope="col">Number of Verbs</th>
                    <th class="font-bold" scope="col">Created</th>
                </tr>
            </thead>
            <tbody>
                @if (SavedMasterLists != null)
                {
                    @foreach (var savedMasterList in SavedMasterLists!)
                    {
                        SavedMasterList localList = savedMasterList;
                        <tr>
                            <td class="text-left">
                                <a class="cursor-pointer" @onclick="() => MasterListClicked(localList)">@localList.ListName</a>
                            </td>
                            <td class="text-center">@localList.TotalRows</td>
                            <td class="text-center">@localList.ListCreationTimestamp.ToLocalTime().ToString("dd.MM.yyyy @ HH':'mm")</td>
                        </tr>
                    }
                }
            </tbody>
        </table>
    </section>

    @*Left side, displays master list once selected*@
    <scetion id="masterListDisplyer" class="@($"flex flex-col px-2 {(IsListSelectorVisible ? "hidden" : "")}")">
        <h4 class="mt-2 text-2xl ml-5 text-center">@ChosenMasterListName</h4>
        <table class="w-full">
            <thead>
                <tr>
                    <th class="font-bold text-center" colspan="5" scope="col">Words</th>
                    <th class="font-bold text-center" scope="col">Selected</th>
                </tr>
            </thead>
            <tbody>
                @if (ChosenMasterListRows != null)
                {
                    @foreach (var chosenListRow in ChosenMasterListRows)
                    {
                        SelectListRowVM localListRow = chosenListRow;
                        <tr @onclick="() => ChosenMasterListRowClicked(localListRow)">
                            <th scope="row" class="text-left">@chosenListRow.RowNum</th>
                            @{
                                int colIndex = 0;
                            }
                            @foreach (var cellWords in localListRow.Words)
                            {
                                int localColIndex = colIndex;
                                <td>@string.Join(" | ", localListRow.Words[localColIndex])</td>
                            }
                            <td class="text-center">
                                @*TODO: add event handler here that sends row ID*@
                                <input type="checkbox" checked=@localListRow.IsSelected @onclick="() => ChosenMasterListCheckChanged(localListRow)">
                            </td>
                        </tr>
                    }
                }
            </tbody>
        </table>
    </scetion>

    @*Right side, displays test-so-far with words chosen from the left*@
    <section id="testRowTable" class="flex flex-col px-2">
        <input class="@($"{TestNameFieldClass} text-center")"
               type="text"
               disabled="@IsSaving"
               placeholder="New Test Name"
               @bind-value="@(TestName)"
               @oninput="OnTestNameInput" />
        <table class="w-full">
            <thead>

            </thead>
            <tbody>

            </tbody>
        </table>
    </section>
</div>

